import os
import pathlib
import sys

import huey

# move to root directory
os.chdir(tuple(parent.parent for parent in pathlib.Path(__file__).parents if parent.name.lower() == 'scripts')[0].as_posix())

def setup_venv():
    os.system('python -m venv .venv && {} -m pip install --extra-index-url https://pypi.org/simple np_queuey')

def dynamicrouting_behavior_session_mtrain_upload():
    os.system('huey_consumer np_queuey.hueys.dynamicrouting_behavior_session_mtrain_upload.huey')
    
    
if __name__ == "__main__":
    try:
        dynamicrouting_behavior_session_mtrain_upload()
    except:
        setup_venv()
        dynamicrouting_behavior_session_mtrain_upload()